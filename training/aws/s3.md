---
title: S3
description: 
published: true
date: 2021-03-17T10:21:06.381Z
tags: aws, cloud, data persistence, s3, object storage
editor: markdown
dateCreated: 2021-03-08T11:59:02.346Z
---

# Amazon S3

**Amazon S3** offre uno storage in cloud sicuro, durevole e altamente scalabile. 
S3 è un sistema cosiddetto *“object-storage”* con una semplice interfaccia web per memorizzare e recuperare i file. 
A livello di pricing, su S3 si paga solamente ciò che si utilizza e la capacità di storage è pressoché infinita.
Esistono diverse *“classi di storage”* progettate per diversi casi di applicazione (general purpose, infrequent access, archive) ed è possibile definire anche delle policy per gestire il ciclo di vita dei dati.
Ovviamente, S3 offre una serie di funzionalità per gestire gli accessi ai file che memorizza.
**Amazon Glacier** è un altro sistema di storage in cloud collegato a S3 ma ottimizzato per l’archiviazione dei dati o per backup a lungo termine, ad un costo veramente basso.

## Object Storage vs Traditional Block and File Storage

In traditional IT environments, 2 tipi di storage predominano:
- **block storage**: opera a basso livello e gestisce i dati come insiemi di blocchi numerati di ugual dimensione;
- **file storage**: opera ad un livello un po’ più alto rispetto al block storage, gestendo i dati come una gerarchia di cartelle e files;

Amazon S3 è invece un **“object storage”**, i cui oggetti risiedono in contenitori chiamati buckets, e in cui ogni oggetto è identificato da una chiave univoca. Può sembrare molto simile ad un file system, in cui gli oggetti equivalgono ai file e le chiavi ai loro nomi, ma non è così. Amazon S3 tratta i dati come oggetti, il che vuol dire che in S3 si può eseguire una GET o una PUT di un oggetto, lavorando sull’intero oggetto invece che aggiornando porzioni dell’oggetto in modo incrementale come accade con i file.

## Basics

### Buckets

Un bucket è un contenitore di oggetti in S3. Ogni oggetto di S3 è contenuto in un bucket. I bucket formano il top-level namespace per S3 e i nomi dei bucket sono **globali**: questo significa che il nome del bucket è **unico** a livello di tutto il mondo AWS.
Il nome del bucket può contenere fino a 63 lettere minuscole, numeri, etc.
All’interno di un account AWS si possono avere al massimo 100 bucket.

### AWS Regions

Nonostante il nome del bucket è **unico a livello globale**, ogni bucket viene creato in una **specifica regione**, che può essere scelta in fase di creazione. Questo consente di avere controllo su dove viene memorizzato il dato.

### Objects

Gli **oggetti** sono le entità memorizzate nei bucket S3. Un oggetto può memorizzare qualsiasi tipo di dato in qualsiasi formato. La massima dimensione di un oggetto è 5TB, mentre non c’è limite sul numero di oggetti memorizzabili in un bucket. Ogni oggetto consiste di **dati** (l’oggetto stesso) e **metadati** (dati relativi all’oggetto).

### Keys

Ogni oggetto memorizzato in S3 è identificato da un identificativo univoco chiamato **“key”**.
La key può arrivare a contenere fino a 1024 bytes (UTF8, compresi slash, etc.).
La combinazione di bucket, key e opzionalmente l’id della versione **identifica univocamente** un oggetto S3.

### Amazon S3 Operations

L’interfaccia API S3 è molto semplice, e include una serie di operazioni comuni:
- Crea/Elimina bucket;
- Scrivi un oggetto;
- Leggi un oggetto;
- Elimina un oggetto;
- Elenca le chiavi in un bucket;
    
### REST Interface

L’interfaccia nativa Amazon S3 è **REST**, esposta sia in http che in https. L’interfaccia REST mappa le operazioni native HTTP con le operazioni **CRUD**:

-  Create (PUT o anche POST);
- Read (GET)
- Update (POST o anche PUT);
- Delete (DELETE)
    
### Durability e Availability

Sono due concetti che rispondono alle seguenti domande:
- **Durability**: “saranno disponibili i miei dati nel futuro?”
- **Availability**: “posso accedere ai miei dati in questo momento?”

Amazon S3 standard è progettato per garantire:
- 99.999999999% di Durability
- 99.99% di Availability

La durevolezza la raggiunge grazie alla memorizzazione automatica ridondante su device multipli all’interno della stessa regione.
Se i dati memorizzati sono facilmente riproducibili (es.: image thumbs) e si vuole ridurre i costi, si può scegliere il **RRS** (Reduced Redundancy Storage) ad un prezzo inferiore.

### Data Consistency

Amazon S3 è un sistema **“eventualmente consistente” (eventual consistency)**.

Poiché i dati sono automaticamente replicati su server multipli e diverse location all’interno di una regione, le modifiche ai dati potrebbero richiedere un po’ di tempo prima di **propagarsi** su tutte le location, con conseguente possibilità di ricevere un dato non aggiornato in caso di letture.

Per la PUT di **nuovi oggetti** non c’è problema (*read after write consistency*).

Per PUT su **oggetti esistenti** o DELETE invece potrebbe verificarsi la “eventual consistency”, ossia una GET in seguito ad una di queste due operazioni potrebbe restituire un dato **non aggiornato**.

### Access Control

Amazon S3 è sicuro di default. Quando si crea un bucket o un oggetto in S3, solo chi lo ha creato ne ha accesso. Per dare accesso ad altri, è possibile sfruttare le **S3 ACLs** e gestire in modo fine le policy di accesso al bucket.

**Amazon S3 ACLs** consentono di dare permessi di lettura, scrittura o full control **a livello di oggetto o intero bucket**. Si tratta di un meccanismo legacy di controllo di accesso in piedi prima dell’avvento di IAM.

**Amazon S3 bucket policies** sono il meccanismo raccomandato per gestire gli accessi alle risorse S3. Funzionano in modo molto simile alle policy IAM, ma si diversificano per:

- sono associate ad un bucket invece che a un IAM principal;
- includono esplicite referenze al IAM principal nella policy;

Utilizzando una bucket policy S3, è possibile specificare chi può accedere al bucket, da dove (tramite *CIDR block* o *IP addresses*) e durante quale periodo del giorno.

### Static Website Hosting

S3 può essere utilizzato per ospitare un **sito web statico**. Il bucket deve:

- avere lo stesso nome del dominio utilizzato;
- contenere i file statici;
- essere lui e tutti i file al suo interno pubblici (world readable);

La URL del sito sarà: ```bucket_name.s3-website-awsregion.amazonaws.com```

## Amazon S3 Advanced Features



## References

- https://docs.aws.amazon.com/AmazonS3/latest/userguide/Welcome.html